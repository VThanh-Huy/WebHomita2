@using Homita.Models
@model List<Homita.Models.ViewModel.CartViewModel>

@{
    ViewBag.Title = "Đặt hàng";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h1 class="text-center my-4">THÔNG TIN GIỎ HÀNG</h1>

@{
    decimal sum = 0;
}

<div class="table-responsive">
    @*<table class="table table-bordered table-hover align-middle">
        <thead class="table-secondary">
            <tr>
                <th style="width:120px;">Hình ảnh</th>
                <th>Tên sản phẩm</th>
                <th>Đơn giá</th>
                <th>Số lượng</th>
                <th>Tổng tiền</th>
                <th>Thao tác</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model)
            {
                var total = item.Gia * item.SoLuong;
                <tr>
                    <td>
                        <img src="@Url.Content("~/Content/images/" + item.HinhAnh)" alt="Ảnh sản phẩm" style="max-width:100px; max-height:100px; object-fit:contain;" />
                    </td>
                    <td>@item.TenSP</td>
                    <td>@String.Format("{0:N0}", item.Gia) VNĐ</td>
                    <td>@item.SoLuong</td>
                    <td>@String.Format("{0:N0}", total) VNĐ</td>
                    <td>
                        <a href="/Cart/Product" class="btn btn-sm btn-secondary">Trở về giỏ hàng</a>
                    </td>
                </tr>
                sum += (decimal)total;
            }
        </tbody>

        <tfoot>
            <tr>
                <th colspan="4" class="text-end">Tổng tiền:</th>
                <th colspan="2" style="color:red; font-weight:bold;">@String.Format("{0:N0}", sum) VNĐ</th>
            </tr>
        </tfoot>
    </table>*@
</div>

<h2 class="text-center my-4">THÔNG TIN ĐẶT HÀNG</h2>

@{
    var kh = ViewBag.kh as Homita.Models.KhachHang;
}

<div class="d-flex justify-content-center">
    <table class="table table-borderless" style="width: 60%;">
        @using (Html.BeginForm())
        {
            @Html.ValidationSummary(true)
            if (kh != null)
            {
                <tr>
                    <td><strong>Họ tên khách hàng:</strong></td>
                    <td>@kh.HoTen</td>
                </tr>
                <tr>
                    <td><strong>Địa chỉ:</strong></td>
                    <td>@kh.DiaChi</td>
                </tr>
                <tr>
                    <td><strong>Điện thoại:</strong></td>
                    <td>@kh.SDT</td>
                </tr>
            }
            else
            {
                <tr>
                    <td colspan="2" class="text-danger">Chưa có thông tin khách hàng.</td>
                </tr>
            }
            <tr>
                <td><strong>Ngày đặt:</strong></td>
                <td>@DateTime.Now.ToShortDateString()</td>
            </tr>
            <tr>
                <td><strong>Phương thức thanh toán:</strong></td>
                <td>
                    <!-- name không nên có dấu, sửa thành "PhuongThucThanhToan" -->
                    <select name="PhuongThucThanhToan" class="form-select" required>
                        <option value="">-- Chọn phương thức --</option>
                        <option value="Tiền mặt">Tiền mặt</option>
                        <option value="Chuyển khoản">Chuyển khoản</option>
                        <option value="Thanh toán online">Thanh toán online</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td></td>
                <td>
                    <input type="submit" value="ĐỒNG Ý ĐẶT HÀNG" class="btn btn-primary" />
                </td>
            </tr>
        }
    </table>
</div>
